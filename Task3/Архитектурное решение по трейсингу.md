

## Планирование


Клиенты жалуются менеджерам по продажам, что они не получили заказ и над их изделием работают уже несколько месяцев, хотя обещали закончить за три недели.

Это может быть вызвано проблемами в потоках данных (Созданный заказ не сохранился):
 - "Internet shop" -> "Shop API" -> "Shop DB"
 - "Internet shop" -> "Shop API" -> "3d file storage" 

Проблемы с подтверждением заказа в CRM могут быть вызваны ошибками в цепочках:
 - "CRM" -> "CRM API" -> "Shop DB"
 - "CRM" -> "CRM API" -> "Message Queue"
 - "CRM" -> "CRM API" -> "3d file storage"


Проблемы с операторов MES с оформлением заказов могут таиться здесь:
 - "MES UI" -> "MES API" -> "MES DB"
 - "MES UI" -> "MES API" -> "Message Queue"
 

В трейсинг должны попасть данные:
 - Order_id
 - User_id

## Мотивация
Добавление трейсинга в систему позволит компании получить более глубокое представление о работе отдельных компонентов системы, что особенно важно при использовании микросервисной архитектуры. Трейсинг информационных потоков помогает учитывать производительность сетевого взаимодействия внутри распределенной системы и выявить узкие места, которые могут замедлять работу приложения . Это даст возможность сократить трудозатраты на поиск ошибок и повысить общую эффективность разработки.

### Какие преимущества принесет внедрение трейсинга:

1. **Сокращение времени на диагностику проблем**  
   Трейсинг облегчает работу, так как даёт чёткую структурированную картину проекта, позволяя быстро находить источник проблемы и проводить анализ состояния проекта . Это существенно сократит время на выявление багов и дефектов, что приведет к более быстрому реагированию на инциденты.

2. **Оптимизация производительности системы**  
   Трейсинг сетевых взаимодействий между сервисами позволяет определить задержки и улучшить скорость работы системы. Это может напрямую повлиять на пользовательский опыт (например, снижение времени загрузки страниц или выполнения запросов).

3. **Повышение качества кода и снижение технического долга**  
   Благодаря трассировке требований в проекте можно соотнести элементы кода с бизнес-требованиями и убедиться, что все части системы работают согласованно. Это также помогает поддерживать контроль над изменениями и минимизировать риск появления "мертвого" кода .

### Метрики, на которые повлияет внедрение трейсинга:

1. **Время до восстановления системы (MTTR)**  
   Быстрая диагностика проблем через трейсинг сократит среднее время устранения неполадок, что является ключевой метрикой для DevOps-команд.

2. **Процент успешных транзакций (Success Rate)**  
   Понимание того, какие запросы завершаются успешно, а какие терпят неудачу, поможет оптимизировать критические бизнес-процессы и повысить общий уровень удовлетворенности клиентов.

3. **Задержки в микросервисах (Latency)**  
   Анализ задержек между вызовами микросервисов позволит определить слабые места в архитектуре и улучшить общую производительность системы .

4. **Производительность команды разработки (Velocity)**  
   Сокращение времени на поиск и исправление ошибок благодаря трейсингу увеличит продуктивность разработчиков, что положительно скажется на скорости выпуска новых функций.

Таким образом, внедрение трейсинга обеспечит комплексное понимание работы системы, снизит операционные издержки и ускорит достижение бизнес-целей компании.

## Предлагаемое решение

Поддержку трейсинга нужно реализовать с помощью инструмента Jaeger.
Для этого в каждом сервисе нужно добавить поддержку Jaeger с помощью стандартных библиотек.


[jewerly_c4_model_tracing.drawio](jewerly_c4_model_tracing.drawio)
![jewerly_c4_model_tracing.drawio](trace.png)


## Компромиссы

Из за возможных сложностей реализации поддержку трейсига через RabbitMQ можно отложить.
Так же можно отложить трейсинг внутри CRM, так как на него не было жалоб. 
Скорее всего наиболее проблемным местом является MES, на нём и нужно сосредоточиться.

## Безопасность

Для предотвращения несанкционированного доступа к системе трейсинга должна быть внедрена аутентификация — зайти в систему смогут только сотрудники компании с актуальной учетной записью и ролью "Поддержка"
